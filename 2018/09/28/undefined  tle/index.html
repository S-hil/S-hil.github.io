<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="123456789%matplotlib inline%reload_ext autoreload%autoreload 2from fastai.structured import *from fastai.column_data import *np.set_printoptions(threshold=50, edgeitems=20)PATH=&apos;data/rossmann/&apos; 123tab">
<meta property="og:type" content="article">
<meta property="og:title" content="Working with a large structured Dataset">
<meta property="og:url" content="http://yoursite.com/2018/09/28/undefined  tle/index.html">
<meta property="og:site_name" content="Welcome to my World">
<meta property="og:description" content="123456789%matplotlib inline%reload_ext autoreload%autoreload 2from fastai.structured import *from fastai.column_data import *np.set_printoptions(threshold=50, edgeitems=20)PATH=&apos;data/rossmann/&apos; 123tab">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2018/09/28/undefined%20%20tle/output_105_0.png">
<meta property="og:image" content="http://yoursite.com/2018/09/28/undefined%20%20tle/output_106_0.png">
<meta property="og:updated_time" content="2018-09-27T23:30:30.782Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Working with a large structured Dataset">
<meta name="twitter:description" content="123456789%matplotlib inline%reload_ext autoreload%autoreload 2from fastai.structured import *from fastai.column_data import *np.set_printoptions(threshold=50, edgeitems=20)PATH=&apos;data/rossmann/&apos; 123tab">
<meta name="twitter:image" content="http://yoursite.com/2018/09/28/undefined%20%20tle/output_105_0.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/09/28/undefined  tle/"/>





  <title>Working with a large structured Dataset | Welcome to my World</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Welcome to my World</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about-me">
          <a href="/About-Me" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            About Me
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/28/undefined  tle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sahil Bansal">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome to my World">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Working with a large structured Dataset</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-28T07:48:27+09:00">
                2018-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line">%reload_ext autoreload</span><br><span class="line">%autoreload <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fastai.structured <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> fastai.column_data <span class="keyword">import</span> *</span><br><span class="line">np.set_printoptions(threshold=<span class="number">50</span>, edgeitems=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">PATH=<span class="string">'data/rossmann/'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">table_names = [<span class="string">'train'</span>, <span class="string">'store'</span>, <span class="string">'store_states'</span>, <span class="string">'state_names'</span>,</span><br><span class="line">               <span class="string">'googletrend'</span>, <span class="string">'weather'</span>, <span class="string">'test'</span>]</span><br><span class="line">tables = [pd.read_csv(<span class="string">f'<span class="subst">&#123;PATH&#125;</span><span class="subst">&#123;fname&#125;</span>.csv'</span>, low_memory=<span class="keyword">False</span>) <span class="keyword">for</span> fname <span class="keyword">in</span> table_names]</span><br></pre></td></tr></table></figure>
<h3 id="collapse"><a href="#collapse" class="headerlink" title="collapse"></a>collapse</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tables: display(t.sample(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Sales</th><br>      <th>Customers</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>399219</th><br>      <td>187</td><br>      <td>4</td><br>      <td>2014-07-10</td><br>      <td>5763</td><br>      <td>779</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>106098</th><br>      <td>174</td><br>      <td>1</td><br>      <td>2015-04-27</td><br>      <td>6796</td><br>      <td>540</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>352481</th><br>      <td>202</td><br>      <td>5</td><br>      <td>2014-08-29</td><br>      <td>5205</td><br>      <td>473</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>590360</th><br>      <td>196</td><br>      <td>6</td><br>      <td>2014-01-18</td><br>      <td>3433</td><br>      <td>529</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>410024</th><br>      <td>490</td><br>      <td>7</td><br>      <td>2014-06-29</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>CompetitionDistance</th><br>      <th>CompetitionOpenSinceMonth</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2</th><br>      <th>Promo2SinceWeek</th><br>      <th>Promo2SinceYear</th><br>      <th>PromoInterval</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>212</th><br>      <td>213</td><br>      <td>d</td><br>      <td>c</td><br>      <td>4030.0</td><br>      <td>3.0</td><br>      <td>2014.0</td><br>      <td>1</td><br>      <td>1.0</td><br>      <td>2014.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>    </tr><br>    <tr><br>      <th>319</th><br>      <td>320</td><br>      <td>a</td><br>      <td>c</td><br>      <td>210.0</td><br>      <td>9.0</td><br>      <td>2012.0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>152</th><br>      <td>153</td><br>      <td>a</td><br>      <td>a</td><br>      <td>16240.0</td><br>      <td>10.0</td><br>      <td>2000.0</td><br>      <td>1</td><br>      <td>18.0</td><br>      <td>2011.0</td><br>      <td>Feb,May,Aug,Nov</td><br>    </tr><br>    <tr><br>      <th>64</th><br>      <td>65</td><br>      <td>a</td><br>      <td>c</td><br>      <td>13840.0</td><br>      <td>5.0</td><br>      <td>2010.0</td><br>      <td>1</td><br>      <td>1.0</td><br>      <td>2012.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>    </tr><br>    <tr><br>      <th>57</th><br>      <td>58</td><br>      <td>a</td><br>      <td>c</td><br>      <td>7340.0</td><br>      <td>5.0</td><br>      <td>2008.0</td><br>      <td>1</td><br>      <td>27.0</td><br>      <td>2012.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>957</th><br>      <td>958</td><br>      <td>BE</td><br>    </tr><br>    <tr><br>      <th>851</th><br>      <td>852</td><br>      <td>HE</td><br>    </tr><br>    <tr><br>      <th>663</th><br>      <td>664</td><br>      <td>ST</td><br>    </tr><br>    <tr><br>      <th>1020</th><br>      <td>1021</td><br>      <td>BE</td><br>    </tr><br>    <tr><br>      <th>683</th><br>      <td>684</td><br>      <td>BY</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>StateName</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>11</th><br>      <td>Saarland</td><br>      <td>SL</td><br>    </tr><br>    <tr><br>      <th>15</th><br>      <td>Thueringen</td><br>      <td>TH</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>Brandenburg</td><br>      <td>BB</td><br>    </tr><br>    <tr><br>      <th>6</th><br>      <td>Hessen</td><br>      <td>HE</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>Bayern</td><br>      <td>BY</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>week</th><br>      <th>trend</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>1118</th><br>      <td>Rossmann_DE_BW</td><br>      <td>2014-06-29 - 2014-07-05</td><br>      <td>76</td><br>    </tr><br>    <tr><br>      <th>1920</th><br>      <td>Rossmann_DE_HH</td><br>      <td>2015-09-06 - 2015-09-12</td><br>      <td>62</td><br>    </tr><br>    <tr><br>      <th>1891</th><br>      <td>Rossmann_DE_HH</td><br>      <td>2015-02-15 - 2015-02-21</td><br>      <td>60</td><br>    </tr><br>    <tr><br>      <th>891</th><br>      <td>Rossmann_DE_RP</td><br>      <td>2012-12-23 - 2012-12-29</td><br>      <td>28</td><br>    </tr><br>    <tr><br>      <th>1529</th><br>      <td>Rossmann_DE_HE</td><br>      <td>2013-11-10 - 2013-11-16</td><br>      <td>57</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>Date</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Dew_PointC</th><br>      <th>MeanDew_PointC</th><br>      <th>Min_DewpointC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Sea_Level_PressurehPa</th><br>      <th>Mean_Sea_Level_PressurehPa</th><br>      <th>Min_Sea_Level_PressurehPa</th><br>      <th>Max_VisibilityKm</th><br>      <th>Mean_VisibilityKm</th><br>      <th>Min_VisibilitykM</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>Max_Gust_SpeedKm_h</th><br>      <th>Precipitationmm</th><br>      <th>CloudCover</th><br>      <th>Events</th><br>      <th>WindDirDegrees</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>11032</th><br>      <td>Berlin</td><br>      <td>2013-05-23</td><br>      <td>15</td><br>      <td>9</td><br>      <td>3</td><br>      <td>4</td><br>      <td>1</td><br>      <td>-3</td><br>      <td>87</td><br>      <td>56</td><br>      <td>20</td><br>      <td>1009</td><br>      <td>1008</td><br>      <td>1006</td><br>      <td>31.0</td><br>      <td>15.0</td><br>      <td>10.0</td><br>      <td>23</td><br>      <td>14</td><br>      <td>NaN</td><br>      <td>0.00</td><br>      <td>2.0</td><br>      <td>NaN</td><br>      <td>252</td><br>    </tr><br>    <tr><br>      <th>5302</th><br>      <td>SachsenAnhalt</td><br>      <td>2013-12-19</td><br>      <td>8</td><br>      <td>5</td><br>      <td>2</td><br>      <td>6</td><br>      <td>3</td><br>      <td>0</td><br>      <td>88</td><br>      <td>78</td><br>      <td>66</td><br>      <td>1015</td><br>      <td>1010</td><br>      <td>1006</td><br>      <td>31.0</td><br>      <td>18.0</td><br>      <td>11.0</td><br>      <td>21</td><br>      <td>11</td><br>      <td>NaN</td><br>      <td>0.51</td><br>      <td>8.0</td><br>      <td>Rain</td><br>      <td>-1</td><br>    </tr><br>    <tr><br>      <th>11631</th><br>      <td>Berlin</td><br>      <td>2015-01-12</td><br>      <td>8</td><br>      <td>4</td><br>      <td>2</td><br>      <td>6</td><br>      <td>4</td><br>      <td>2</td><br>      <td>95</td><br>      <td>88</td><br>      <td>74</td><br>      <td>1014</td><br>      <td>1012</td><br>      <td>1009</td><br>      <td>31.0</td><br>      <td>12.0</td><br>      <td>6.0</td><br>      <td>35</td><br>      <td>27</td><br>      <td>52.0</td><br>      <td>3.05</td><br>      <td>7.0</td><br>      <td>Rain</td><br>      <td>236</td><br>    </tr><br>    <tr><br>      <th>14071</th><br>      <td>Thueringen</td><br>      <td>2013-07-31</td><br>      <td>22</td><br>      <td>19</td><br>      <td>16</td><br>      <td>16</td><br>      <td>14</td><br>      <td>13</td><br>      <td>100</td><br>      <td>73</td><br>      <td>51</td><br>      <td>1020</td><br>      <td>1018</td><br>      <td>1016</td><br>      <td>31.0</td><br>      <td>11.0</td><br>      <td>3.0</td><br>      <td>32</td><br>      <td>18</td><br>      <td>NaN</td><br>      <td>0.00</td><br>      <td>5.0</td><br>      <td>Rain</td><br>      <td>243</td><br>    </tr><br>    <tr><br>      <th>10275</th><br>      <td>BadenWuerttemberg</td><br>      <td>2014-01-11</td><br>      <td>7</td><br>      <td>2</td><br>      <td>-3</td><br>      <td>6</td><br>      <td>2</td><br>      <td>-2</td><br>      <td>100</td><br>      <td>96</td><br>      <td>79</td><br>      <td>1025</td><br>      <td>1019</td><br>      <td>1016</td><br>      <td>19.0</td><br>      <td>10.0</td><br>      <td>6.0</td><br>      <td>21</td><br>      <td>5</td><br>      <td>NaN</td><br>      <td>3.05</td><br>      <td>6.0</td><br>      <td>Fog-Rain</td><br>      <td>318</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Id</th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>13212</th><br>      <td>13213</td><br>      <td>488</td><br>      <td>3</td><br>      <td>2015-09-02</td><br>      <td>1.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>40727</th><br>      <td>40728</td><br>      <td>642</td><br>      <td>6</td><br>      <td>2015-08-01</td><br>      <td>1.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2079</th><br>      <td>2080</td><br>      <td>481</td><br>      <td>2</td><br>      <td>2015-09-15</td><br>      <td>1.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>25258</th><br>      <td>25259</td><br>      <td>563</td><br>      <td>3</td><br>      <td>2015-08-19</td><br>      <td>1.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>6935</th><br>      <td>6936</td><br>      <td>117</td><br>      <td>3</td><br>      <td>2015-09-09</td><br>      <td>1.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br></div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tables[<span class="number">0</span>].sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Sales</th><br>      <th>Customers</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>160173</th><br>      <td>729</td><br>      <td>2</td><br>      <td>2015-03-10</td><br>      <td>9371</td><br>      <td>999</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>263937</th><br>      <td>528</td><br>      <td>2</td><br>      <td>2014-12-02</td><br>      <td>14313</td><br>      <td>1045</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>910025</th><br>      <td>971</td><br>      <td>7</td><br>      <td>2013-04-07</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>928189</th><br>      <td>180</td><br>      <td>4</td><br>      <td>2013-03-21</td><br>      <td>7684</td><br>      <td>888</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>278268</th><br>      <td>896</td><br>      <td>1</td><br>      <td>2014-11-17</td><br>      <td>6900</td><br>      <td>1102</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tables: display(DataFrameSummary(t).summary())</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Sales</th><br>      <th>Customers</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>1.01721e+06</td><br>      <td>1.01721e+06</td><br>      <td>NaN</td><br>      <td>1.01721e+06</td><br>      <td>1.01721e+06</td><br>      <td>1.01721e+06</td><br>      <td>1.01721e+06</td><br>      <td>NaN</td><br>      <td>1.01721e+06</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>558.43</td><br>      <td>3.99834</td><br>      <td>NaN</td><br>      <td>5773.82</td><br>      <td>633.146</td><br>      <td>0.830107</td><br>      <td>0.381515</td><br>      <td>NaN</td><br>      <td>0.178647</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>321.909</td><br>      <td>1.99739</td><br>      <td>NaN</td><br>      <td>3849.93</td><br>      <td>464.412</td><br>      <td>0.375539</td><br>      <td>0.485759</td><br>      <td>NaN</td><br>      <td>0.383056</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>280</td><br>      <td>2</td><br>      <td>NaN</td><br>      <td>3727</td><br>      <td>405</td><br>      <td>1</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>558</td><br>      <td>4</td><br>      <td>NaN</td><br>      <td>5744</td><br>      <td>609</td><br>      <td>1</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>838</td><br>      <td>6</td><br>      <td>NaN</td><br>      <td>7856</td><br>      <td>837</td><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>1115</td><br>      <td>7</td><br>      <td>NaN</td><br>      <td>41551</td><br>      <td>7388</td><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>      <td>1017209</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>1115</td><br>      <td>7</td><br>      <td>942</td><br>      <td>21734</td><br>      <td>4086</td><br>      <td>2</td><br>      <td>2</td><br>      <td>4</td><br>      <td>2</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>categorical</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>bool</td><br>      <td>bool</td><br>      <td>categorical</td><br>      <td>bool</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>CompetitionDistance</th><br>      <th>CompetitionOpenSinceMonth</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2</th><br>      <th>Promo2SinceWeek</th><br>      <th>Promo2SinceYear</th><br>      <th>PromoInterval</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>1115</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1112</td><br>      <td>761</td><br>      <td>761</td><br>      <td>1115</td><br>      <td>571</td><br>      <td>571</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>558</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>5404.9</td><br>      <td>7.2247</td><br>      <td>2008.67</td><br>      <td>0.512108</td><br>      <td>23.5954</td><br>      <td>2011.76</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>322.017</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>7663.17</td><br>      <td>3.21235</td><br>      <td>6.19598</td><br>      <td>0.500078</td><br>      <td>14.142</td><br>      <td>1.67494</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>20</td><br>      <td>1</td><br>      <td>1900</td><br>      <td>0</td><br>      <td>1</td><br>      <td>2009</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>279.5</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>717.5</td><br>      <td>4</td><br>      <td>2006</td><br>      <td>0</td><br>      <td>13</td><br>      <td>2011</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>558</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2325</td><br>      <td>8</td><br>      <td>2010</td><br>      <td>1</td><br>      <td>22</td><br>      <td>2012</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>836.5</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>6882.5</td><br>      <td>10</td><br>      <td>2013</td><br>      <td>1</td><br>      <td>37</td><br>      <td>2013</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>1115</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>75860</td><br>      <td>12</td><br>      <td>2015</td><br>      <td>1</td><br>      <td>50</td><br>      <td>2015</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>1115</td><br>      <td>1115</td><br>      <td>1115</td><br>      <td>1112</td><br>      <td>761</td><br>      <td>761</td><br>      <td>1115</td><br>      <td>571</td><br>      <td>571</td><br>      <td>571</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>1115</td><br>      <td>4</td><br>      <td>3</td><br>      <td>654</td><br>      <td>12</td><br>      <td>23</td><br>      <td>2</td><br>      <td>24</td><br>      <td>7</td><br>      <td>3</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>3</td><br>      <td>354</td><br>      <td>354</td><br>      <td>0</td><br>      <td>544</td><br>      <td>544</td><br>      <td>544</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0.27%</td><br>      <td>31.75%</td><br>      <td>31.75%</td><br>      <td>0%</td><br>      <td>48.79%</td><br>      <td>48.79%</td><br>      <td>48.79%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>numeric</td><br>      <td>categorical</td><br>      <td>categorical</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>bool</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>categorical</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>1115</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>558</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>322.017</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>279.5</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>558</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>836.5</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>1115</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>1115</td><br>      <td>1115</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>1115</td><br>      <td>12</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>numeric</td><br>      <td>categorical</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>StateName</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>16</td><br>      <td>16</td><br>    </tr><br>    <tr><br>      <th>unique</th><br>      <td>16</td><br>      <td>16</td><br>    </tr><br>    <tr><br>      <th>top</th><br>      <td>Hamburg</td><br>      <td>HB,NI</td><br>    </tr><br>    <tr><br>      <th>freq</th><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>16</td><br>      <td>16</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>16</td><br>      <td>16</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>unique</td><br>      <td>unique</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>week</th><br>      <th>trend</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2072</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>63.8142</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>12.6502</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>55</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>64</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>72</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>100</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>2072</td><br>      <td>2072</td><br>      <td>2072</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>14</td><br>      <td>148</td><br>      <td>68</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>categorical</td><br>      <td>categorical</td><br>      <td>numeric</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>Date</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Dew_PointC</th><br>      <th>MeanDew_PointC</th><br>      <th>Min_DewpointC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Sea_Level_PressurehPa</th><br>      <th>Mean_Sea_Level_PressurehPa</th><br>      <th>Min_Sea_Level_PressurehPa</th><br>      <th>Max_VisibilityKm</th><br>      <th>Mean_VisibilityKm</th><br>      <th>Min_VisibilitykM</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>Max_Gust_SpeedKm_h</th><br>      <th>Precipitationmm</th><br>      <th>CloudCover</th><br>      <th>Events</th><br>      <th>WindDirDegrees</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15459</td><br>      <td>15459</td><br>      <td>15459</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>3604</td><br>      <td>15840</td><br>      <td>14667</td><br>      <td>NaN</td><br>      <td>15840</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>14.6441</td><br>      <td>10.389</td><br>      <td>6.19899</td><br>      <td>8.58782</td><br>      <td>6.20581</td><br>      <td>3.62614</td><br>      <td>93.6596</td><br>      <td>74.2829</td><br>      <td>50.1586</td><br>      <td>1018.53</td><br>      <td>1015.3</td><br>      <td>1012.31</td><br>      <td>24.0576</td><br>      <td>12.2398</td><br>      <td>7.02516</td><br>      <td>22.7666</td><br>      <td>11.9722</td><br>      <td>48.8643</td><br>      <td>0.831718</td><br>      <td>5.55131</td><br>      <td>NaN</td><br>      <td>175.897</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>8.64601</td><br>      <td>7.37926</td><br>      <td>6.52639</td><br>      <td>6.24478</td><br>      <td>6.08677</td><br>      <td>6.12839</td><br>      <td>7.67853</td><br>      <td>13.4866</td><br>      <td>19.9602</td><br>      <td>7.78872</td><br>      <td>8.12331</td><br>      <td>8.60058</td><br>      <td>8.9768</td><br>      <td>5.06794</td><br>      <td>4.9806</td><br>      <td>8.98862</td><br>      <td>5.87284</td><br>      <td>13.027</td><br>      <td>2.51351</td><br>      <td>1.68771</td><br>      <td>NaN</td><br>      <td>101.589</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>-11</td><br>      <td>-13</td><br>      <td>-15</td><br>      <td>-14</td><br>      <td>-15</td><br>      <td>-73</td><br>      <td>44</td><br>      <td>30</td><br>      <td>4</td><br>      <td>976</td><br>      <td>974</td><br>      <td>970</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>3</td><br>      <td>2</td><br>      <td>21</td><br>      <td>0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>-1</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>8</td><br>      <td>4</td><br>      <td>1</td><br>      <td>4</td><br>      <td>2</td><br>      <td>-1</td><br>      <td>90.75</td><br>      <td>65</td><br>      <td>34</td><br>      <td>1014</td><br>      <td>1010</td><br>      <td>1007</td><br>      <td>14</td><br>      <td>10</td><br>      <td>3</td><br>      <td>16</td><br>      <td>8</td><br>      <td>39</td><br>      <td>0</td><br>      <td>5</td><br>      <td>NaN</td><br>      <td>80</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>15</td><br>      <td>11</td><br>      <td>7</td><br>      <td>9</td><br>      <td>7</td><br>      <td>4</td><br>      <td>94</td><br>      <td>76</td><br>      <td>49</td><br>      <td>1019</td><br>      <td>1016</td><br>      <td>1013</td><br>      <td>31</td><br>      <td>11</td><br>      <td>7</td><br>      <td>21</td><br>      <td>11</td><br>      <td>48</td><br>      <td>0</td><br>      <td>6</td><br>      <td>NaN</td><br>      <td>202</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>21</td><br>      <td>16</td><br>      <td>11</td><br>      <td>13</td><br>      <td>11</td><br>      <td>8</td><br>      <td>100</td><br>      <td>85</td><br>      <td>66</td><br>      <td>1024</td><br>      <td>1021</td><br>      <td>1018</td><br>      <td>31</td><br>      <td>14</td><br>      <td>10</td><br>      <td>27</td><br>      <td>14</td><br>      <td>55</td><br>      <td>0.25</td><br>      <td>7</td><br>      <td>NaN</td><br>      <td>256</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>39</td><br>      <td>31</td><br>      <td>24</td><br>      <td>25</td><br>      <td>20</td><br>      <td>19</td><br>      <td>100</td><br>      <td>100</td><br>      <td>100</td><br>      <td>1043</td><br>      <td>1040</td><br>      <td>1038</td><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>      <td>101</td><br>      <td>53</td><br>      <td>111</td><br>      <td>58.93</td><br>      <td>8</td><br>      <td>NaN</td><br>      <td>360</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>15459</td><br>      <td>15459</td><br>      <td>15459</td><br>      <td>15840</td><br>      <td>15840</td><br>      <td>3604</td><br>      <td>15840</td><br>      <td>14667</td><br>      <td>11889</td><br>      <td>15840</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>16</td><br>      <td>990</td><br>      <td>51</td><br>      <td>45</td><br>      <td>40</td><br>      <td>40</td><br>      <td>36</td><br>      <td>40</td><br>      <td>53</td><br>      <td>71</td><br>      <td>93</td><br>      <td>67</td><br>      <td>67</td><br>      <td>69</td><br>      <td>24</td><br>      <td>32</td><br>      <td>24</td><br>      <td>44</td><br>      <td>29</td><br>      <td>47</td><br>      <td>41</td><br>      <td>9</td><br>      <td>21</td><br>      <td>362</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>381</td><br>      <td>381</td><br>      <td>381</td><br>      <td>0</td><br>      <td>0</td><br>      <td>12236</td><br>      <td>0</td><br>      <td>1173</td><br>      <td>3951</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>2.41%</td><br>      <td>2.41%</td><br>      <td>2.41%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>77.25%</td><br>      <td>0%</td><br>      <td>7.41%</td><br>      <td>24.94%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>categorical</td><br>      <td>categorical</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>categorical</td><br>      <td>numeric</td><br>    </tr><br>  </tbody><br></table><br></div>



<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Id</th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>41088</td><br>      <td>41088</td><br>      <td>41088</td><br>      <td>NaN</td><br>      <td>41077</td><br>      <td>41088</td><br>      <td>NaN</td><br>      <td>41088</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>20544.5</td><br>      <td>555.9</td><br>      <td>3.97917</td><br>      <td>NaN</td><br>      <td>0.854322</td><br>      <td>0.395833</td><br>      <td>NaN</td><br>      <td>0.443487</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>11861.2</td><br>      <td>320.274</td><br>      <td>2.01548</td><br>      <td>NaN</td><br>      <td>0.352787</td><br>      <td>0.489035</td><br>      <td>NaN</td><br>      <td>0.496802</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>10272.8</td><br>      <td>279.75</td><br>      <td>2</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>20544.5</td><br>      <td>553.5</td><br>      <td>4</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>30816.2</td><br>      <td>832.25</td><br>      <td>6</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>41088</td><br>      <td>1115</td><br>      <td>7</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>1</td><br>      <td>NaN</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>counts</th><br>      <td>41088</td><br>      <td>41088</td><br>      <td>41088</td><br>      <td>41088</td><br>      <td>41077</td><br>      <td>41088</td><br>      <td>41088</td><br>      <td>41088</td><br>    </tr><br>    <tr><br>      <th>uniques</th><br>      <td>41088</td><br>      <td>856</td><br>      <td>7</td><br>      <td>48</td><br>      <td>2</td><br>      <td>2</td><br>      <td>2</td><br>      <td>2</td><br>    </tr><br>    <tr><br>      <th>missing</th><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>11</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>missing_perc</th><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0.03%</td><br>      <td>0%</td><br>      <td>0%</td><br>      <td>0%</td><br>    </tr><br>    <tr><br>      <th>types</th><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>numeric</td><br>      <td>categorical</td><br>      <td>bool</td><br>      <td>bool</td><br>      <td>bool</td><br>      <td>bool</td><br>    </tr><br>  </tbody><br></table><br></div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train, store, store_states, state_names, googletrend, weather, test = tables</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(train),len(test)</span><br></pre></td></tr></table></figure>
<pre><code>(1017209, 41088)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Sales</th><br>      <th>Customers</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>711566</th><br>      <td>982</td><br>      <td>3</td><br>      <td>2013-10-02</td><br>      <td>6378</td><br>      <td>659</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>36797</th><br>      <td>3</td><br>      <td>7</td><br>      <td>2015-06-28</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>239657</th><br>      <td>564</td><br>      <td>7</td><br>      <td>2014-12-28</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>230503</th><br>      <td>814</td><br>      <td>2</td><br>      <td>2015-01-06</td><br>      <td>11005</td><br>      <td>802</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>17589</th><br>      <td>865</td><br>      <td>4</td><br>      <td>2015-07-16</td><br>      <td>7545</td><br>      <td>616</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train.StateHoliday = train.StateHoliday!=<span class="string">'0'</span></span><br><span class="line">test.StateHoliday = test.StateHoliday!=<span class="string">'0'</span></span><br></pre></td></tr></table></figure>
<p>join_df is a function for joining tables on specific fields.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int(<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>1
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.options.display.max_columns=<span class="number">39</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weather.sample(<span class="number">5</span>)[<span class="number">1</span>:<span class="number">2</span>][:]</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>Date</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Dew_PointC</th><br>      <th>MeanDew_PointC</th><br>      <th>Min_DewpointC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Sea_Level_PressurehPa</th><br>      <th>Mean_Sea_Level_PressurehPa</th><br>      <th>Min_Sea_Level_PressurehPa</th><br>      <th>Max_VisibilityKm</th><br>      <th>Mean_VisibilityKm</th><br>      <th>Min_VisibilitykM</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>Max_Gust_SpeedKm_h</th><br>      <th>Precipitationmm</th><br>      <th>CloudCover</th><br>      <th>Events</th><br>      <th>WindDirDegrees</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>3427</th><br>      <td>Bremen</td><br>      <td>2014-04-03</td><br>      <td>19</td><br>      <td>12</td><br>      <td>5</td><br>      <td>10</td><br>      <td>8</td><br>      <td>5</td><br>      <td>100</td><br>      <td>72</td><br>      <td>44</td><br>      <td>1006</td><br>      <td>1005</td><br>      <td>1003</td><br>      <td>19.0</td><br>      <td>10.0</td><br>      <td>3.0</td><br>      <td>26</td><br>      <td>11</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>NaN</td><br>      <td>Fog</td><br>      <td>53</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weather.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>Date</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Dew_PointC</th><br>      <th>MeanDew_PointC</th><br>      <th>Min_DewpointC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Sea_Level_PressurehPa</th><br>      <th>Mean_Sea_Level_PressurehPa</th><br>      <th>Min_Sea_Level_PressurehPa</th><br>      <th>Max_VisibilityKm</th><br>      <th>Mean_VisibilityKm</th><br>      <th>Min_VisibilitykM</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>Max_Gust_SpeedKm_h</th><br>      <th>Precipitationmm</th><br>      <th>CloudCover</th><br>      <th>Events</th><br>      <th>WindDirDegrees</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>7898</th><br>      <td>Hessen</td><br>      <td>2015-08-27</td><br>      <td>29</td><br>      <td>21</td><br>      <td>14</td><br>      <td>18</td><br>      <td>14</td><br>      <td>11</td><br>      <td>94</td><br>      <td>64</td><br>      <td>26</td><br>      <td>1013</td><br>      <td>1011</td><br>      <td>1008</td><br>      <td>31.0</td><br>      <td>11.0</td><br>      <td>10.0</td><br>      <td>32</td><br>      <td>8</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>6.0</td><br>      <td>Rain</td><br>      <td>234</td><br>    </tr><br>    <tr><br>      <th>2031</th><br>      <td>Bayern</td><br>      <td>2013-02-21</td><br>      <td>-2</td><br>      <td>-4</td><br>      <td>-6</td><br>      <td>-5</td><br>      <td>-7</td><br>      <td>-10</td><br>      <td>100</td><br>      <td>82</td><br>      <td>64</td><br>      <td>1018</td><br>      <td>1015</td><br>      <td>1013</td><br>      <td>10.0</td><br>      <td>9.0</td><br>      <td>4.0</td><br>      <td>24</td><br>      <td>14</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>7.0</td><br>      <td>Snow</td><br>      <td>48</td><br>    </tr><br>    <tr><br>      <th>2454</th><br>      <td>Bayern</td><br>      <td>2014-04-20</td><br>      <td>16</td><br>      <td>11</td><br>      <td>7</td><br>      <td>8</td><br>      <td>6</td><br>      <td>4</td><br>      <td>93</td><br>      <td>71</td><br>      <td>51</td><br>      <td>1008</td><br>      <td>1006</td><br>      <td>1005</td><br>      <td>10.0</td><br>      <td>9.0</td><br>      <td>5.0</td><br>      <td>32</td><br>      <td>16</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>4.0</td><br>      <td>Fog</td><br>      <td>77</td><br>    </tr><br>    <tr><br>      <th>5400</th><br>      <td>SachsenAnhalt</td><br>      <td>2014-03-27</td><br>      <td>14</td><br>      <td>7</td><br>      <td>0</td><br>      <td>3</td><br>      <td>2</td><br>      <td>1</td><br>      <td>95</td><br>      <td>58</td><br>      <td>31</td><br>      <td>1020</td><br>      <td>1018</td><br>      <td>1016</td><br>      <td>31.0</td><br>      <td>19.0</td><br>      <td>6.0</td><br>      <td>14</td><br>      <td>10</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>8.0</td><br>      <td>NaN</td><br>      <td>-1</td><br>    </tr><br>    <tr><br>      <th>14434</th><br>      <td>Thueringen</td><br>      <td>2014-07-29</td><br>      <td>24</td><br>      <td>20</td><br>      <td>16</td><br>      <td>19</td><br>      <td>18</td><br>      <td>15</td><br>      <td>100</td><br>      <td>84</td><br>      <td>59</td><br>      <td>1011</td><br>      <td>1009</td><br>      <td>1006</td><br>      <td>31.0</td><br>      <td>11.0</td><br>      <td>0.0</td><br>      <td>19</td><br>      <td>8</td><br>      <td>NaN</td><br>      <td>0.0</td><br>      <td>6.0</td><br>      <td>Fog-Rain-Thunderstorm</td><br>      <td>12</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state_names.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>StateName</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>14</th><br>      <td>SchleswigHolstein</td><br>      <td>SH</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>Bremen</td><br>      <td>HB</td><br>    </tr><br>    <tr><br>      <th>11</th><br>      <td>Saarland</td><br>      <td>SL</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>Bayern</td><br>      <td>BY</td><br>    </tr><br>    <tr><br>      <th>5</th><br>      <td>Hamburg</td><br>      <td>HH</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weather = weather.merge(state_names,how=<span class="string">'left'</span>,left_on=<span class="string">"file"</span>,right_on=<span class="string">"StateName"</span>,</span><br><span class="line">                         suffixes=(<span class="string">""</span>,<span class="string">"x"</span>))</span><br></pre></td></tr></table></figure>
<h2> Shape of Weather is : ,39 </h2>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.shape(weather)</span><br></pre></td></tr></table></figure>
<pre><code>(15840, 26)
</code></pre><h2> Table Names - train, store, store_states, state_names, googletrend, weather, test </h2>

<h2>Making new colums in google trends</h2>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">googletrend.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>week</th><br>      <th>trend</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>774</th><br>      <td>Rossmann_DE_BE</td><br>      <td>2013-07-28 - 2013-08-03</td><br>      <td>88</td><br>    </tr><br>    <tr><br>      <th>580</th><br>      <td>Rossmann_DE_TH</td><br>      <td>2015-07-12 - 2015-07-18</td><br>      <td>83</td><br>    </tr><br>    <tr><br>      <th>829</th><br>      <td>Rossmann_DE_BE</td><br>      <td>2014-08-17 - 2014-08-23</td><br>      <td>77</td><br>    </tr><br>    <tr><br>      <th>1097</th><br>      <td>Rossmann_DE_BW</td><br>      <td>2014-02-02 - 2014-02-08</td><br>      <td>61</td><br>    </tr><br>    <tr><br>      <th>1701</th><br>      <td>Rossmann_DE_ST</td><br>      <td>2014-04-27 - 2014-05-03</td><br>      <td>68</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">googletrend[<span class="string">'Date'</span>] = googletrend.week.str.split(<span class="string">' - '</span>, expand=<span class="keyword">True</span>)[<span class="number">0</span>]</span><br><span class="line">googletrend[<span class="string">'State'</span>]=googletrend.file.str.split(<span class="string">'_'</span>,expand=<span class="keyword">True</span>)[<span class="number">2</span>]</span><br><span class="line">googletrend.loc[googletrend.State==<span class="string">'NI'</span>, <span class="string">"State"</span>] = <span class="string">'HB,NI'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add_datepart(weather, <span class="string">"Date"</span>, drop=<span class="keyword">False</span>)</span><br><span class="line">add_datepart(googletrend, <span class="string">"Date"</span>, drop=<span class="keyword">False</span>)</span><br><span class="line">add_datepart(train, <span class="string">"Date"</span>, drop=<span class="keyword">False</span>)</span><br><span class="line">add_datepart(test, <span class="string">"Date"</span>, drop=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trend_de = googletrend[googletrend.file == <span class="string">'Rossmann_DE'</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trend_de.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>file</th><br>      <th>week</th><br>      <th>trend</th><br>      <th>Date</th><br>      <th>State</th><br>      <th>Year</th><br>      <th>Month</th><br>      <th>Week</th><br>      <th>Day</th><br>      <th>Dayofweek</th><br>      <th>Dayofyear</th><br>      <th>Is_month_end</th><br>      <th>Is_month_start</th><br>      <th>Is_quarter_end</th><br>      <th>Is_quarter_start</th><br>      <th>Is_year_end</th><br>      <th>Is_year_start</th><br>      <th>Elapsed</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>229</th><br>      <td>Rossmann_DE</td><br>      <td>2014-06-22 - 2014-06-28</td><br>      <td>62</td><br>      <td>2014-06-22</td><br>      <td>None</td><br>      <td>2014</td><br>      <td>6</td><br>      <td>25</td><br>      <td>22</td><br>      <td>6</td><br>      <td>173</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>1403395200</td><br>    </tr><br>    <tr><br>      <th>221</th><br>      <td>Rossmann_DE</td><br>      <td>2014-04-27 - 2014-05-03</td><br>      <td>74</td><br>      <td>2014-04-27</td><br>      <td>None</td><br>      <td>2014</td><br>      <td>4</td><br>      <td>17</td><br>      <td>27</td><br>      <td>6</td><br>      <td>117</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>1398556800</td><br>    </tr><br>    <tr><br>      <th>284</th><br>      <td>Rossmann_DE</td><br>      <td>2015-07-12 - 2015-07-18</td><br>      <td>86</td><br>      <td>2015-07-12</td><br>      <td>None</td><br>      <td>2015</td><br>      <td>7</td><br>      <td>28</td><br>      <td>12</td><br>      <td>6</td><br>      <td>193</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>1436659200</td><br>    </tr><br>    <tr><br>      <th>238</th><br>      <td>Rossmann_DE</td><br>      <td>2014-08-24 - 2014-08-30</td><br>      <td>66</td><br>      <td>2014-08-24</td><br>      <td>None</td><br>      <td>2014</td><br>      <td>8</td><br>      <td>34</td><br>      <td>24</td><br>      <td>6</td><br>      <td>236</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>1408838400</td><br>    </tr><br>    <tr><br>      <th>247</th><br>      <td>Rossmann_DE</td><br>      <td>2014-10-26 - 2014-11-01</td><br>      <td>63</td><br>      <td>2014-10-26</td><br>      <td>None</td><br>      <td>2014</td><br>      <td>10</td><br>      <td>43</td><br>      <td>26</td><br>      <td>6</td><br>      <td>299</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>1414281600</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>CompetitionDistance</th><br>      <th>CompetitionOpenSinceMonth</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2</th><br>      <th>Promo2SinceWeek</th><br>      <th>Promo2SinceYear</th><br>      <th>PromoInterval</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>681</th><br>      <td>682</td><br>      <td>b</td><br>      <td>a</td><br>      <td>150.0</td><br>      <td>9.0</td><br>      <td>2006.0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>669</th><br>      <td>670</td><br>      <td>a</td><br>      <td>a</td><br>      <td>2060.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>45.0</td><br>      <td>2009.0</td><br>      <td>Feb,May,Aug,Nov</td><br>    </tr><br>    <tr><br>      <th>683</th><br>      <td>684</td><br>      <td>d</td><br>      <td>c</td><br>      <td>680.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>22.0</td><br>      <td>2012.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>    </tr><br>    <tr><br>      <th>901</th><br>      <td>902</td><br>      <td>a</td><br>      <td>a</td><br>      <td>310.0</td><br>      <td>5.0</td><br>      <td>2015.0</td><br>      <td>1</td><br>      <td>40.0</td><br>      <td>2014.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>    </tr><br>    <tr><br>      <th>1107</th><br>      <td>1108</td><br>      <td>a</td><br>      <td>a</td><br>      <td>540.0</td><br>      <td>4.0</td><br>      <td>2004.0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store_states.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>996</th><br>      <td>997</td><br>      <td>HE</td><br>    </tr><br>    <tr><br>      <th>663</th><br>      <td>664</td><br>      <td>ST</td><br>    </tr><br>    <tr><br>      <th>8</th><br>      <td>9</td><br>      <td>NW</td><br>    </tr><br>    <tr><br>      <th>287</th><br>      <td>288</td><br>      <td>BY</td><br>    </tr><br>    <tr><br>      <th>669</th><br>      <td>670</td><br>      <td>BY</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">join_df</span><span class="params">(left, right, left_on, right_on=None, suffix=<span class="string">'_y'</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> right_on <span class="keyword">is</span> <span class="keyword">None</span>: right_on = left_on</span><br><span class="line">    <span class="keyword">return</span> left.merge(right, how=<span class="string">'left'</span>, left_on=left_on, right_on=right_on,</span><br><span class="line">                      suffixes=(<span class="string">""</span>, suffix))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">store = join_df(store, store_states, <span class="string">"Store"</span>)</span><br><span class="line">len(store[store.State.isnull()])</span><br></pre></td></tr></table></figure>
<pre><code>0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined = join_df(train, store, <span class="string">"Store"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store_states.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>937</th><br>      <td>938</td><br>      <td>HB,NI</td><br>    </tr><br>    <tr><br>      <th>406</th><br>      <td>407</td><br>      <td>BY</td><br>    </tr><br>    <tr><br>      <th>518</th><br>      <td>519</td><br>      <td>SH</td><br>    </tr><br>    <tr><br>      <th>1028</th><br>      <td>1029</td><br>      <td>ST</td><br>    </tr><br>    <tr><br>      <th>906</th><br>      <td>907</td><br>      <td>NW</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>CompetitionDistance</th><br>      <th>CompetitionOpenSinceMonth</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2</th><br>      <th>Promo2SinceWeek</th><br>      <th>Promo2SinceYear</th><br>      <th>PromoInterval</th><br>      <th>State</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>309</th><br>      <td>310</td><br>      <td>a</td><br>      <td>c</td><br>      <td>2290.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>10.0</td><br>      <td>2014.0</td><br>      <td>Mar,Jun,Sept,Dec</td><br>      <td>SH</td><br>    </tr><br>    <tr><br>      <th>888</th><br>      <td>889</td><br>      <td>d</td><br>      <td>a</td><br>      <td>18670.0</td><br>      <td>12.0</td><br>      <td>2005.0</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>ST</td><br>    </tr><br>    <tr><br>      <th>715</th><br>      <td>716</td><br>      <td>d</td><br>      <td>a</td><br>      <td>3200.0</td><br>      <td>1.0</td><br>      <td>2008.0</td><br>      <td>1</td><br>      <td>22.0</td><br>      <td>2011.0</td><br>      <td>Jan,Apr,Jul,Oct</td><br>      <td>BY</td><br>    </tr><br>    <tr><br>      <th>424</th><br>      <td>425</td><br>      <td>d</td><br>      <td>c</td><br>      <td>1460.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NW</td><br>    </tr><br>    <tr><br>      <th>561</th><br>      <td>562</td><br>      <td>b</td><br>      <td>c</td><br>      <td>1210.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>HB,NI</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">joined = join_df(train, store, <span class="string">"Store"</span>)</span><br><span class="line">joined_test = join_df(test, store, <span class="string">"Store"</span>)</span><br><span class="line">len(joined[joined.StoreType.isnull()]),len(joined_test[joined_test.StoreType.isnull()])</span><br></pre></td></tr></table></figure>
<pre><code>(0, 0)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">joined = join_df(joined, googletrend, [<span class="string">"State"</span>,<span class="string">"Year"</span>, <span class="string">"Week"</span>])</span><br><span class="line">joined_test = join_df(joined_test, googletrend, [<span class="string">"State"</span>,<span class="string">"Year"</span>, <span class="string">"Week"</span>])</span><br><span class="line">len(joined[joined.trend.isnull()]),len(joined_test[joined_test.trend.isnull()])</span><br></pre></td></tr></table></figure>
<pre><code>(0, 0)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">joined = joined.merge(trend_de, <span class="string">'left'</span>, [<span class="string">"Year"</span>, <span class="string">"Week"</span>], suffixes=(<span class="string">''</span>, <span class="string">'_DE'</span>))</span><br><span class="line">joined_test = joined_test.merge(trend_de, <span class="string">'left'</span>, [<span class="string">"Year"</span>, <span class="string">"Week"</span>], suffixes=(<span class="string">''</span>, <span class="string">'_DE'</span>))</span><br><span class="line">len(joined[joined.trend_DE.isnull()]),len(joined_test[joined_test.trend_DE.isnull()])</span><br></pre></td></tr></table></figure>
<pre><code>(0, 0)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">joined = join_df(joined, weather, [<span class="string">"State"</span>,<span class="string">"Date"</span>])</span><br><span class="line">joined_test = join_df(joined_test, weather, [<span class="string">"State"</span>,<span class="string">"Date"</span>])</span><br><span class="line">len(joined[joined.Mean_TemperatureC.isnull()]),len(joined_test[joined_test.Mean_TemperatureC.isnull()])</span><br></pre></td></tr></table></figure>
<pre><code>(0, 0)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined, joined_test):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> df.columns:</span><br><span class="line">        <span class="keyword">if</span> c.endswith(<span class="string">'_y'</span>):</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">in</span> df.columns: df.drop(c, inplace=<span class="keyword">True</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df[<span class="string">'CompetitionOpenSinceYear'</span>] = df.CompetitionOpenSinceYear.fillna(<span class="number">1900</span>).astype(np.int32)</span><br><span class="line">    df[<span class="string">'CompetitionOpenSinceMonth'</span>] = df.CompetitionOpenSinceMonth.fillna(<span class="number">1</span>).astype(np.int32)</span><br><span class="line">    df[<span class="string">'Promo2SinceYear'</span>] = df.Promo2SinceYear.fillna(<span class="number">1900</span>).astype(np.int32)</span><br><span class="line">    df[<span class="string">'Promo2SinceWeek'</span>] = df.Promo2SinceWeek.fillna(<span class="number">1</span>).astype(np.int32)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df[<span class="string">"CompetitionOpenSince"</span>] = pd.to_datetime(dict(year=df.CompetitionOpenSinceYear,</span><br><span class="line">                                                     month=df.CompetitionOpenSinceMonth, day=<span class="number">15</span>))</span><br><span class="line">    df[<span class="string">"CompetitionDaysOpen"</span>] = df.Date.subtract(df.CompetitionOpenSince).dt.days</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df.loc[df.CompetitionDaysOpen&lt;<span class="number">0</span>, <span class="string">"CompetitionDaysOpen"</span>] = <span class="number">0</span></span><br><span class="line">    df.loc[df.CompetitionOpenSinceYear&lt;<span class="number">1990</span>, <span class="string">"CompetitionDaysOpen"</span>] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df[<span class="string">"CompetitionMonthsOpen"</span>] = df[<span class="string">"CompetitionDaysOpen"</span>]//<span class="number">30</span></span><br><span class="line">    df.loc[df.CompetitionMonthsOpen&gt;<span class="number">24</span>, <span class="string">"CompetitionMonthsOpen"</span>] = <span class="number">24</span></span><br><span class="line">joined.CompetitionMonthsOpen.unique()</span><br></pre></td></tr></table></figure>
<pre><code>array([24,  3, 19,  9,  0, 16, 17,  7, 15, 22, 11, 13,  2, 23, 12,  4, 10,  1, 14, 20,  8, 18,  6, 21,  5])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df[<span class="string">"Promo2Since"</span>] = pd.to_datetime(df.apply(<span class="keyword">lambda</span> x: Week(</span><br><span class="line">        x.Promo2SinceYear, x.Promo2SinceWeek).monday(), axis=<span class="number">1</span>).astype(pd.datetime))</span><br><span class="line">    df[<span class="string">"Promo2Days"</span>] = df.Date.subtract(df[<span class="string">"Promo2Since"</span>]).dt.days</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> (joined,joined_test):</span><br><span class="line">    df.loc[df.Promo2Days&lt;<span class="number">0</span>, <span class="string">"Promo2Days"</span>] = <span class="number">0</span></span><br><span class="line">    df.loc[df.Promo2SinceYear&lt;<span class="number">1990</span>, <span class="string">"Promo2Days"</span>] = <span class="number">0</span></span><br><span class="line">    df[<span class="string">"Promo2Weeks"</span>] = df[<span class="string">"Promo2Days"</span>]//<span class="number">7</span></span><br><span class="line">    df.loc[df.Promo2Weeks&lt;<span class="number">0</span>, <span class="string">"Promo2Weeks"</span>] = <span class="number">0</span></span><br><span class="line">    df.loc[df.Promo2Weeks&gt;<span class="number">25</span>, <span class="string">"Promo2Weeks"</span>] = <span class="number">25</span></span><br><span class="line">    df.Promo2Weeks.unique()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">joined.to_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined'</span>)</span><br><span class="line">joined_test.to_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined_test'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined.sample(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Date</th><br>      <th>Sales</th><br>      <th>Customers</th><br>      <th>Open</th><br>      <th>Promo</th><br>      <th>StateHoliday</th><br>      <th>SchoolHoliday</th><br>      <th>Year</th><br>      <th>Month</th><br>      <th>Week</th><br>      <th>Day</th><br>      <th>Dayofweek</th><br>      <th>Dayofyear</th><br>      <th>Is_month_end</th><br>      <th>Is_month_start</th><br>      <th>Is_quarter_end</th><br>      <th>Is_quarter_start</th><br>      <th></th><br>      <th>Mean_Sea_Level_PressurehPa</th><br>      <th>Min_Sea_Level_PressurehPa</th><br>      <th>Max_VisibilityKm</th><br>      <th>Mean_VisibilityKm</th><br>      <th>Min_VisibilitykM</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>Max_Gust_SpeedKm_h</th><br>      <th>Precipitationmm</th><br>      <th>CloudCover</th><br>      <th>Events</th><br>      <th>WindDirDegrees</th><br>      <th>StateName</th><br>      <th>CompetitionOpenSince</th><br>      <th>CompetitionDaysOpen</th><br>      <th>CompetitionMonthsOpen</th><br>      <th>Promo2Since</th><br>      <th>Promo2Days</th><br>      <th>Promo2Weeks</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>373150</th><br>      <td>318</td><br>      <td>4</td><br>      <td>2014-08-07</td><br>      <td>7642</td><br>      <td>682</td><br>      <td>1</td><br>      <td>1</td><br>      <td>False</td><br>      <td>1</td><br>      <td>2014</td><br>      <td>8</td><br>      <td>32</td><br>      <td>7</td><br>      <td>3</td><br>      <td>219</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td></td><br>      <td>1015</td><br>      <td>1014</td><br>      <td>31.0</td><br>      <td>16.0</td><br>      <td>4.0</td><br>      <td>21</td><br>      <td>8</td><br>      <td>NaN</td><br>      <td>9.91</td><br>      <td>6.0</td><br>      <td>Rain-Thunderstorm</td><br>      <td>83</td><br>      <td>Sachsen</td><br>      <td>2014-03-15</td><br>      <td>145</td><br>      <td>4</td><br>      <td>1900-01-01</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>864308</th><br>      <td>969</td><br>      <td>6</td><br>      <td>2013-05-18</td><br>      <td>2325</td><br>      <td>426</td><br>      <td>1</td><br>      <td>0</td><br>      <td>False</td><br>      <td>0</td><br>      <td>2013</td><br>      <td>5</td><br>      <td>20</td><br>      <td>18</td><br>      <td>5</td><br>      <td>138</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td></td><br>      <td>1007</td><br>      <td>1005</td><br>      <td>31.0</td><br>      <td>12.0</td><br>      <td>10.0</td><br>      <td>19</td><br>      <td>6</td><br>      <td>NaN</td><br>      <td>0.00</td><br>      <td>4.0</td><br>      <td>NaN</td><br>      <td>137</td><br>      <td>BadenWuerttemberg</td><br>      <td>1999-11-15</td><br>      <td>4933</td><br>      <td>24</td><br>      <td>2013-03-04</td><br>      <td>75</td><br>      <td>10</td><br>    </tr><br>    <tr><br>      <th>247609</th><br>      <td>10</td><br>      <td>5</td><br>      <td>2014-12-19</td><br>      <td>6922</td><br>      <td>710</td><br>      <td>1</td><br>      <td>1</td><br>      <td>False</td><br>      <td>0</td><br>      <td>2014</td><br>      <td>12</td><br>      <td>51</td><br>      <td>19</td><br>      <td>4</td><br>      <td>353</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td></td><br>      <td>1008</td><br>      <td>1005</td><br>      <td>19.0</td><br>      <td>8.0</td><br>      <td>3.0</td><br>      <td>35</td><br>      <td>27</td><br>      <td>55.0</td><br>      <td>6.10</td><br>      <td>6.0</td><br>      <td>Rain</td><br>      <td>251</td><br>      <td>Niedersachsen</td><br>      <td>2009-09-15</td><br>      <td>1921</td><br>      <td>24</td><br>      <td>1900-01-01</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>152414</th><br>      <td>775</td><br>      <td>2</td><br>      <td>2015-03-17</td><br>      <td>8550</td><br>      <td>569</td><br>      <td>1</td><br>      <td>1</td><br>      <td>False</td><br>      <td>0</td><br>      <td>2015</td><br>      <td>3</td><br>      <td>12</td><br>      <td>17</td><br>      <td>1</td><br>      <td>76</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td></td><br>      <td>1023</td><br>      <td>1022</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>27</td><br>      <td>14</td><br>      <td>NaN</td><br>      <td>0.00</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>77</td><br>      <td>Bayern</td><br>      <td>2005-12-15</td><br>      <td>3379</td><br>      <td>24</td><br>      <td>2011-05-30</td><br>      <td>1387</td><br>      <td>25</td><br>    </tr><br>    <tr><br>      <th>428973</th><br>      <td>484</td><br>      <td>4</td><br>      <td>2014-06-12</td><br>      <td>6426</td><br>      <td>641</td><br>      <td>1</td><br>      <td>0</td><br>      <td>False</td><br>      <td>0</td><br>      <td>2014</td><br>      <td>6</td><br>      <td>24</td><br>      <td>12</td><br>      <td>3</td><br>      <td>163</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td></td><br>      <td>1025</td><br>      <td>1023</td><br>      <td>31.0</td><br>      <td>12.0</td><br>      <td>3.0</td><br>      <td>21</td><br>      <td>10</td><br>      <td>NaN</td><br>      <td>0.00</td><br>      <td>3.0</td><br>      <td>NaN</td><br>      <td>283</td><br>      <td>SchleswigHolstein</td><br>      <td>2011-03-15</td><br>      <td>1185</td><br>      <td>24</td><br>      <td>1900-01-01</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows  80 columns</p><br></div>



<h2 id="Durations"><a href="#Durations" class="headerlink" title="Durations"></a>Durations</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_elapsed</span><span class="params">(fld, pre)</span>:</span></span><br><span class="line">    day1 = np.timedelta64(<span class="number">1</span>, <span class="string">'D'</span>)</span><br><span class="line">    last_date = np.datetime64()</span><br><span class="line">    last_store = <span class="number">0</span></span><br><span class="line">    res = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s,v,d <span class="keyword">in</span> zip(df.Store.values,df[fld].values, df.Date.values):</span><br><span class="line">        <span class="keyword">if</span> s != last_store:</span><br><span class="line">            last_date = np.datetime64()</span><br><span class="line">            last_store = s</span><br><span class="line">        <span class="keyword">if</span> v: last_date = d</span><br><span class="line">        res.append(((d-last_date).astype(<span class="string">'timedelta64[D]'</span>) / day1))</span><br><span class="line">    df[pre+fld] = res</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">columns = [<span class="string">"Date"</span>, <span class="string">"Store"</span>, <span class="string">"Promo"</span>, <span class="string">"StateHoliday"</span>, <span class="string">"SchoolHoliday"</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = train[columns]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = test[columns]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fld = <span class="string">'SchoolHoliday'</span></span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'After'</span>)</span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>], ascending=[<span class="keyword">True</span>, <span class="keyword">False</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'Before'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fld = <span class="string">'StateHoliday'</span></span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'After'</span>)</span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>], ascending=[<span class="keyword">True</span>, <span class="keyword">False</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'Before'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fld = <span class="string">'Promo'</span></span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'After'</span>)</span><br><span class="line">df = df.sort_values([<span class="string">'Store'</span>, <span class="string">'Date'</span>], ascending=[<span class="keyword">True</span>, <span class="keyword">False</span>])</span><br><span class="line">get_elapsed(fld, <span class="string">'Before'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df.set_index(<span class="string">"Date"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">columns = [<span class="string">'SchoolHoliday'</span>, <span class="string">'StateHoliday'</span>, <span class="string">'Promo'</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> [<span class="string">'Before'</span>, <span class="string">'After'</span>]:</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> columns:</span><br><span class="line">        a = o+p</span><br><span class="line">        df[a] = df[a].fillna(<span class="number">0</span>).astype(int)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bwd = df[[<span class="string">'Store'</span>]+columns].sort_index().groupby(<span class="string">"Store"</span>).rolling(<span class="number">7</span>, min_periods=<span class="number">1</span>).sum()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fwd = df[[<span class="string">'Store'</span>]+columns].sort_index(ascending=<span class="keyword">False</span></span><br><span class="line">                                      ).groupby(<span class="string">"Store"</span>).rolling(<span class="number">7</span>, min_periods=<span class="number">1</span>).sum()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bwd.drop(<span class="string">'Store'</span>,<span class="number">1</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">bwd.reset_index(inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fwd.drop(<span class="string">'Store'</span>,<span class="number">1</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">fwd.reset_index(inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.reset_index(inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = df.merge(bwd, <span class="string">'left'</span>, [<span class="string">'Date'</span>, <span class="string">'Store'</span>], suffixes=[<span class="string">''</span>, <span class="string">'_bw'</span>])</span><br><span class="line">df = df.merge(fwd, <span class="string">'left'</span>, [<span class="string">'Date'</span>, <span class="string">'Store'</span>], suffixes=[<span class="string">''</span>, <span class="string">'_fw'</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(columns,<span class="number">1</span>,inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Date</th><br>      <th>Store</th><br>      <th>AfterSchoolHoliday</th><br>      <th>BeforeSchoolHoliday</th><br>      <th>AfterStateHoliday</th><br>      <th>BeforeStateHoliday</th><br>      <th>AfterPromo</th><br>      <th>BeforePromo</th><br>      <th>SchoolHoliday_bw</th><br>      <th>StateHoliday_bw</th><br>      <th>Promo_bw</th><br>      <th>SchoolHoliday_fw</th><br>      <th>StateHoliday_fw</th><br>      <th>Promo_fw</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>2015-09-17</td><br>      <td>1</td><br>      <td>13</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>4.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>1.0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>2015-09-16</td><br>      <td>1</td><br>      <td>12</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>3.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>2.0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>2015-09-15</td><br>      <td>1</td><br>      <td>11</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>2.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>3.0</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>2015-09-14</td><br>      <td>1</td><br>      <td>10</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>1.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>4.0</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>2015-09-13</td><br>      <td>1</td><br>      <td>9</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>9</td><br>      <td>-1</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>4.0</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>df'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>df'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"Date"</span>] = pd.to_datetime(df.Date)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&apos;Date&apos;, &apos;Store&apos;, &apos;AfterSchoolHoliday&apos;, &apos;BeforeSchoolHoliday&apos;,
       &apos;AfterStateHoliday&apos;, &apos;BeforeStateHoliday&apos;, &apos;AfterPromo&apos;, &apos;BeforePromo&apos;,
       &apos;SchoolHoliday_bw&apos;, &apos;StateHoliday_bw&apos;, &apos;Promo_bw&apos;, &apos;SchoolHoliday_fw&apos;,
       &apos;StateHoliday_fw&apos;, &apos;Promo_fw&apos;],
      dtype=&apos;object&apos;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined = join_df(joined, df, [<span class="string">'Store'</span>, <span class="string">'Date'</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined_test = join_df(joined_test, df, [<span class="string">'Store'</span>, <span class="string">'Date'</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined = joined[joined.Sales!=<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">joined.reset_index(inplace=<span class="keyword">True</span>)</span><br><span class="line">joined_test.reset_index(inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">joined.to_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined'</span>)</span><br><span class="line">joined_test.to_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined_test'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Create-features"><a href="#Create-features" class="headerlink" title="Create features"></a>Create features</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">joined = pd.read_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined'</span>)</span><br><span class="line">joined_test = pd.read_feather(<span class="string">f'<span class="subst">&#123;PATH&#125;</span>joined_test'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined.head().T.head(<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>0</th><br>      <th>1</th><br>      <th>2</th><br>      <th>3</th><br>      <th>4</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>index</th><br>      <td>0</td><br>      <td>1</td><br>      <td>2</td><br>      <td>3</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>Store</th><br>      <td>1</td><br>      <td>2</td><br>      <td>3</td><br>      <td>4</td><br>      <td>5</td><br>    </tr><br>    <tr><br>      <th>DayOfWeek</th><br>      <td>5</td><br>      <td>5</td><br>      <td>5</td><br>      <td>5</td><br>      <td>5</td><br>    </tr><br>    <tr><br>      <th>Date</th><br>      <td>2015-07-31 00:00:00</td><br>      <td>2015-07-31 00:00:00</td><br>      <td>2015-07-31 00:00:00</td><br>      <td>2015-07-31 00:00:00</td><br>      <td>2015-07-31 00:00:00</td><br>    </tr><br>    <tr><br>      <th>Sales</th><br>      <td>5263</td><br>      <td>6064</td><br>      <td>8314</td><br>      <td>13995</td><br>      <td>4822</td><br>    </tr><br>    <tr><br>      <th>Customers</th><br>      <td>555</td><br>      <td>625</td><br>      <td>821</td><br>      <td>1498</td><br>      <td>559</td><br>    </tr><br>    <tr><br>      <th>Open</th><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>Promo</th><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>StateHoliday</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>SchoolHoliday</th><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>Year</th><br>      <td>2015</td><br>      <td>2015</td><br>      <td>2015</td><br>      <td>2015</td><br>      <td>2015</td><br>    </tr><br>    <tr><br>      <th>Month</th><br>      <td>7</td><br>      <td>7</td><br>      <td>7</td><br>      <td>7</td><br>      <td>7</td><br>    </tr><br>    <tr><br>      <th>Week</th><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>    </tr><br>    <tr><br>      <th>Day</th><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>      <td>31</td><br>    </tr><br>    <tr><br>      <th>Dayofweek</th><br>      <td>4</td><br>      <td>4</td><br>      <td>4</td><br>      <td>4</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>Dayofyear</th><br>      <td>212</td><br>      <td>212</td><br>      <td>212</td><br>      <td>212</td><br>      <td>212</td><br>    </tr><br>    <tr><br>      <th>Is_month_end</th><br>      <td>True</td><br>      <td>True</td><br>      <td>True</td><br>      <td>True</td><br>      <td>True</td><br>    </tr><br>    <tr><br>      <th>Is_month_start</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>Is_quarter_end</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>Is_quarter_start</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>Is_year_end</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>Is_year_start</th><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>      <td>False</td><br>    </tr><br>    <tr><br>      <th>Elapsed</th><br>      <td>1438300800</td><br>      <td>1438300800</td><br>      <td>1438300800</td><br>      <td>1438300800</td><br>      <td>1438300800</td><br>    </tr><br>    <tr><br>      <th>StoreType</th><br>      <td>c</td><br>      <td>a</td><br>      <td>a</td><br>      <td>c</td><br>      <td>a</td><br>    </tr><br>    <tr><br>      <th>Assortment</th><br>      <td>a</td><br>      <td>a</td><br>      <td>a</td><br>      <td>c</td><br>      <td>a</td><br>    </tr><br>    <tr><br>      <th>CompetitionDistance</th><br>      <td>1270</td><br>      <td>570</td><br>      <td>14130</td><br>      <td>620</td><br>      <td>29910</td><br>    </tr><br>    <tr><br>      <th>CompetitionOpenSinceMonth</th><br>      <td>9</td><br>      <td>11</td><br>      <td>12</td><br>      <td>9</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>CompetitionOpenSinceYear</th><br>      <td>2008</td><br>      <td>2007</td><br>      <td>2006</td><br>      <td>2009</td><br>      <td>2015</td><br>    </tr><br>    <tr><br>      <th>Promo2</th><br>      <td>0</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>Promo2SinceWeek</th><br>      <td>1</td><br>      <td>13</td><br>      <td>14</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>Promo2SinceYear</th><br>      <td>1900</td><br>      <td>2010</td><br>      <td>2011</td><br>      <td>1900</td><br>      <td>1900</td><br>    </tr><br>    <tr><br>      <th>PromoInterval</th><br>      <td>None</td><br>      <td>Jan,Apr,Jul,Oct</td><br>      <td>Jan,Apr,Jul,Oct</td><br>      <td>None</td><br>      <td>None</td><br>    </tr><br>    <tr><br>      <th>State</th><br>      <td>HE</td><br>      <td>TH</td><br>      <td>NW</td><br>      <td>BE</td><br>      <td>SN</td><br>    </tr><br>    <tr><br>      <th>file</th><br>      <td>Rossmann_DE_HE</td><br>      <td>Rossmann_DE_TH</td><br>      <td>Rossmann_DE_NW</td><br>      <td>Rossmann_DE_BE</td><br>      <td>Rossmann_DE_SN</td><br>    </tr><br>    <tr><br>      <th>week</th><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>    </tr><br>    <tr><br>      <th>trend</th><br>      <td>85</td><br>      <td>80</td><br>      <td>86</td><br>      <td>74</td><br>      <td>82</td><br>    </tr><br>    <tr><br>      <th>file_DE</th><br>      <td>Rossmann_DE</td><br>      <td>Rossmann_DE</td><br>      <td>Rossmann_DE</td><br>      <td>Rossmann_DE</td><br>      <td>Rossmann_DE</td><br>    </tr><br>    <tr><br>      <th>week_DE</th><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>      <td>2015-08-02 - 2015-08-08</td><br>    </tr><br>    <tr><br>      <th>trend_DE</th><br>      <td>83</td><br>      <td>83</td><br>      <td>83</td><br>      <td>83</td><br>      <td>83</td><br>    </tr><br>    <tr><br>      <th>Date_DE</th><br>      <td>2015-08-02 00:00:00</td><br>      <td>2015-08-02 00:00:00</td><br>      <td>2015-08-02 00:00:00</td><br>      <td>2015-08-02 00:00:00</td><br>      <td>2015-08-02 00:00:00</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat_vars = [<span class="string">'Store'</span>, <span class="string">'DayOfWeek'</span>, <span class="string">'Year'</span>, <span class="string">'Month'</span>, <span class="string">'Day'</span>, <span class="string">'StateHoliday'</span>, <span class="string">'CompetitionMonthsOpen'</span>,</span><br><span class="line">    <span class="string">'Promo2Weeks'</span>, <span class="string">'StoreType'</span>, <span class="string">'Assortment'</span>, <span class="string">'PromoInterval'</span>, <span class="string">'CompetitionOpenSinceYear'</span>, <span class="string">'Promo2SinceYear'</span>,</span><br><span class="line">    <span class="string">'State'</span>, <span class="string">'Week'</span>, <span class="string">'Events'</span>, <span class="string">'Promo_fw'</span>, <span class="string">'Promo_bw'</span>, <span class="string">'StateHoliday_fw'</span>, <span class="string">'StateHoliday_bw'</span>,</span><br><span class="line">    <span class="string">'SchoolHoliday_fw'</span>, <span class="string">'SchoolHoliday_bw'</span>]</span><br><span class="line"></span><br><span class="line">contin_vars = [<span class="string">'CompetitionDistance'</span>, <span class="string">'Max_TemperatureC'</span>, <span class="string">'Mean_TemperatureC'</span>, <span class="string">'Min_TemperatureC'</span>,</span><br><span class="line">   <span class="string">'Max_Humidity'</span>, <span class="string">'Mean_Humidity'</span>, <span class="string">'Min_Humidity'</span>, <span class="string">'Max_Wind_SpeedKm_h'</span>,</span><br><span class="line">   <span class="string">'Mean_Wind_SpeedKm_h'</span>, <span class="string">'CloudCover'</span>, <span class="string">'trend'</span>, <span class="string">'trend_DE'</span>,</span><br><span class="line">   <span class="string">'AfterStateHoliday'</span>, <span class="string">'BeforeStateHoliday'</span>, <span class="string">'Promo'</span>, <span class="string">'SchoolHoliday'</span>]</span><br><span class="line"></span><br><span class="line">n = len(joined); n</span><br></pre></td></tr></table></figure>
<pre><code>844338
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dep = <span class="string">'Sales'</span></span><br><span class="line">joined = joined[cat_vars+contin_vars+[dep, <span class="string">'Date'</span>]].copy()</span><br><span class="line"></span><br><span class="line">joined_test[dep] = <span class="number">0</span></span><br><span class="line">joined_test = joined_test[cat_vars+contin_vars+[dep, <span class="string">'Date'</span>, <span class="string">'Id'</span>]].copy()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> cat_vars: joined[v] = joined[v].astype(<span class="string">'category'</span>).cat.as_ordered()</span><br><span class="line"></span><br><span class="line">apply_cats(joined_test, joined)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> contin_vars:</span><br><span class="line">    joined[v] = joined[v].astype(<span class="string">'float32'</span>)</span><br><span class="line">    joined_test[v] = joined_test[v].astype(<span class="string">'float32'</span>)</span><br></pre></td></tr></table></figure>
<p>Were going to run on a sample.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">idxs = get_cv_idxs(n, val_pct=<span class="number">150000</span>/n)</span><br><span class="line">joined_samp = joined.iloc[idxs].set_index(<span class="string">"Date"</span>)</span><br><span class="line">samp_size = len(joined_samp); samp_size</span><br></pre></td></tr></table></figure>
<pre><code>150000
</code></pre><p>To run on the full dataset, use this instead:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">samp_size = n</span><br><span class="line">joined_samp = joined.set_index(<span class="string">"Date"</span>)</span><br></pre></td></tr></table></figure>
<p>We can now process our data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined_samp.head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Year</th><br>      <th>Month</th><br>      <th>Day</th><br>      <th>StateHoliday</th><br>      <th>CompetitionMonthsOpen</th><br>      <th>Promo2Weeks</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>PromoInterval</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2SinceYear</th><br>      <th>State</th><br>      <th>Week</th><br>      <th>Events</th><br>      <th>Promo_fw</th><br>      <th>Promo_bw</th><br>      <th>StateHoliday_fw</th><br>      <th>StateHoliday_bw</th><br>      <th>SchoolHoliday_fw</th><br>      <th>SchoolHoliday_bw</th><br>      <th>CompetitionDistance</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>CloudCover</th><br>      <th>trend</th><br>      <th>trend_DE</th><br>      <th>AfterStateHoliday</th><br>      <th>BeforeStateHoliday</th><br>      <th>Promo</th><br>      <th>SchoolHoliday</th><br>      <th>Sales</th><br>    </tr><br>    <tr><br>      <th>Date</th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>2015-07-31</th><br>      <td>1</td><br>      <td>5</td><br>      <td>2015</td><br>      <td>7</td><br>      <td>31</td><br>      <td>False</td><br>      <td>24</td><br>      <td>0</td><br>      <td>c</td><br>      <td>a</td><br>      <td>NaN</td><br>      <td>2008</td><br>      <td>1900</td><br>      <td>HE</td><br>      <td>31</td><br>      <td>Fog</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1270.0</td><br>      <td>23.0</td><br>      <td>16.0</td><br>      <td>8.0</td><br>      <td>98.0</td><br>      <td>54.0</td><br>      <td>18.0</td><br>      <td>24.0</td><br>      <td>11.0</td><br>      <td>1.0</td><br>      <td>85.0</td><br>      <td>83.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1.0</td><br>      <td>1.0</td><br>      <td>5263</td><br>    </tr><br>    <tr><br>      <th>2015-07-31</th><br>      <td>2</td><br>      <td>5</td><br>      <td>2015</td><br>      <td>7</td><br>      <td>31</td><br>      <td>False</td><br>      <td>24</td><br>      <td>25</td><br>      <td>a</td><br>      <td>a</td><br>      <td>Jan,Apr,Jul,Oct</td><br>      <td>2007</td><br>      <td>2010</td><br>      <td>TH</td><br>      <td>31</td><br>      <td>Fog</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>570.0</td><br>      <td>19.0</td><br>      <td>13.0</td><br>      <td>7.0</td><br>      <td>100.0</td><br>      <td>62.0</td><br>      <td>25.0</td><br>      <td>14.0</td><br>      <td>11.0</td><br>      <td>4.0</td><br>      <td>80.0</td><br>      <td>83.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1.0</td><br>      <td>1.0</td><br>      <td>6064</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">joined_samp[<span class="string">'AfterStateHoliday'</span>]=joined_samp[<span class="string">'AfterStateHoliday'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">joined_samp[<span class="string">'BeforeStateHoliday'</span>]=joined_samp[<span class="string">'BeforeStateHoliday'</span>].fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df, y, nas, mapper = proc_df(joined_samp, <span class="string">'Sales'</span>, do_scale=<span class="keyword">True</span>)</span><br><span class="line">yl = np.log(y)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined_test = joined_test.set_index(<span class="string">"Date"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_test, _, nas, mapper = proc_df(joined_test, <span class="string">'Sales'</span>, do_scale=<span class="keyword">True</span>, skip_flds=[<span class="string">'Id'</span>],</span><br><span class="line">                                  mapper=mapper, na_dict=nas)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Store</th><br>      <th>DayOfWeek</th><br>      <th>Year</th><br>      <th>Month</th><br>      <th>Day</th><br>      <th>StateHoliday</th><br>      <th>CompetitionMonthsOpen</th><br>      <th>Promo2Weeks</th><br>      <th>StoreType</th><br>      <th>Assortment</th><br>      <th>PromoInterval</th><br>      <th>CompetitionOpenSinceYear</th><br>      <th>Promo2SinceYear</th><br>      <th>State</th><br>      <th>Week</th><br>      <th>Events</th><br>      <th>Promo_fw</th><br>      <th>Promo_bw</th><br>      <th>StateHoliday_fw</th><br>      <th></th><br>      <th>SchoolHoliday_bw</th><br>      <th>CompetitionDistance</th><br>      <th>Max_TemperatureC</th><br>      <th>Mean_TemperatureC</th><br>      <th>Min_TemperatureC</th><br>      <th>Max_Humidity</th><br>      <th>Mean_Humidity</th><br>      <th>Min_Humidity</th><br>      <th>Max_Wind_SpeedKm_h</th><br>      <th>Mean_Wind_SpeedKm_h</th><br>      <th>CloudCover</th><br>      <th>trend</th><br>      <th>trend_DE</th><br>      <th>AfterStateHoliday</th><br>      <th>BeforeStateHoliday</th><br>      <th>Promo</th><br>      <th>SchoolHoliday</th><br>      <th>CompetitionDistance_na</th><br>      <th>CloudCover_na</th><br>    </tr><br>    <tr><br>      <th>Date</th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>      <th></th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>2015-07-31</th><br>      <td>1</td><br>      <td>5</td><br>      <td>3</td><br>      <td>7</td><br>      <td>31</td><br>      <td>1</td><br>      <td>25</td><br>      <td>1</td><br>      <td>3</td><br>      <td>1</td><br>      <td>0</td><br>      <td>16</td><br>      <td>1</td><br>      <td>5</td><br>      <td>31</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td></td><br>      <td>0</td><br>      <td>-0.535827</td><br>      <td>1.008113</td><br>      <td>0.806978</td><br>      <td>0.317856</td><br>      <td>0.614244</td><br>      <td>-1.507606</td><br>      <td>-1.620066</td><br>      <td>0.149027</td><br>      <td>-0.142774</td><br>      <td>-2.805667</td><br>      <td>1.732492</td><br>      <td>1.724334</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>1.113717</td><br>      <td>2.04105</td><br>      <td>-0.050948</td><br>      <td>-0.29609</td><br>    </tr><br>    <tr><br>      <th>2015-07-31</th><br>      <td>2</td><br>      <td>5</td><br>      <td>3</td><br>      <td>7</td><br>      <td>31</td><br>      <td>1</td><br>      <td>25</td><br>      <td>26</td><br>      <td>1</td><br>      <td>1</td><br>      <td>2</td><br>      <td>15</td><br>      <td>3</td><br>      <td>12</td><br>      <td>31</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td></td><br>      <td>0</td><br>      <td>-0.625558</td><br>      <td>0.538548</td><br>      <td>0.394117</td><br>      <td>0.163376</td><br>      <td>0.873262</td><br>      <td>-0.902093</td><br>      <td>-1.264031</td><br>      <td>-0.960613</td><br>      <td>-0.142774</td><br>      <td>-0.961766</td><br>      <td>1.294578</td><br>      <td>1.724334</td><br>      <td>0.0</td><br>      <td>0.0</td><br>      <td>1.113717</td><br>      <td>2.04105</td><br>      <td>-0.050948</td><br>      <td>-0.29609</td><br>    </tr><br>  </tbody><br></table><br><p>2 rows  40 columns</p><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## DLtrain_ratio = 0.75</span></span><br><span class="line">train_ratio = <span class="number">0.9</span></span><br><span class="line">train_size = int(samp_size * train_ratio); train_size</span><br><span class="line">val_idx = list(range(train_size, len(df)))</span><br></pre></td></tr></table></figure>
<p>An even better option for picking a validation set is using the exact same length of time period as the test set uses - this is implemented here:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val_idx = np.flatnonzero(</span><br><span class="line">    (df.index&lt;=datetime.datetime(<span class="number">2014</span>,<span class="number">9</span>,<span class="number">17</span>)) &amp; (df.index&gt;=datetime.datetime(<span class="number">2014</span>,<span class="number">8</span>,<span class="number">1</span>)))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val_idx=[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h2 id="DL"><a href="#DL" class="headerlink" title="DL"></a>DL</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv_y</span><span class="params">(a)</span>:</span> <span class="keyword">return</span> np.exp(a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp_rmspe</span><span class="params">(y_pred, targ)</span>:</span></span><br><span class="line">    targ = inv_y(targ)</span><br><span class="line">    pct_var = (targ - inv_y(y_pred))/targ</span><br><span class="line">    <span class="keyword">return</span> math.sqrt((pct_var**<span class="number">2</span>).mean())</span><br><span class="line"></span><br><span class="line">max_log_y = np.max(yl)</span><br><span class="line">y_range = (<span class="number">0</span>, max_log_y*<span class="number">1.2</span>)</span><br></pre></td></tr></table></figure>
<p>We can create a ModelData object directly from out data frame.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">md = ColumnarModelData.from_data_frame(PATH, val_idx, df, yl.astype(np.float32), cat_flds=cat_vars, bs=<span class="number">128</span>,</span><br><span class="line">                                       test_df=df_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat_sz = [(c, len(joined_samp[c].cat.categories)+<span class="number">1</span>) <span class="keyword">for</span> c <span class="keyword">in</span> cat_vars]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat_sz</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;Store&apos;, 1116),
 (&apos;DayOfWeek&apos;, 8),
 (&apos;Year&apos;, 4),
 (&apos;Month&apos;, 13),
 (&apos;Day&apos;, 32),
 (&apos;StateHoliday&apos;, 3),
 (&apos;CompetitionMonthsOpen&apos;, 26),
 (&apos;Promo2Weeks&apos;, 27),
 (&apos;StoreType&apos;, 5),
 (&apos;Assortment&apos;, 4),
 (&apos;PromoInterval&apos;, 4),
 (&apos;CompetitionOpenSinceYear&apos;, 24),
 (&apos;Promo2SinceYear&apos;, 9),
 (&apos;State&apos;, 13),
 (&apos;Week&apos;, 53),
 (&apos;Events&apos;, 22),
 (&apos;Promo_fw&apos;, 1),
 (&apos;Promo_bw&apos;, 1),
 (&apos;StateHoliday_fw&apos;, 1),
 (&apos;StateHoliday_bw&apos;, 1),
 (&apos;SchoolHoliday_fw&apos;, 1),
 (&apos;SchoolHoliday_bw&apos;, 1)]
</code></pre><p>We use the <em>cardinality</em> of each variable (that is, its number of unique values) to decide how large to make its <em>embeddings</em>. Each level will be associated with a vector with length defined as below.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emb_szs = [(c, min(<span class="number">50</span>, (c+<span class="number">1</span>)//<span class="number">2</span>)) <span class="keyword">for</span> _,c <span class="keyword">in</span> cat_sz]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emb_szs</span><br></pre></td></tr></table></figure>
<pre><code>[(1116, 50),
 (8, 4),
 (4, 2),
 (13, 7),
 (32, 16),
 (3, 2),
 (26, 13),
 (27, 14),
 (5, 3),
 (4, 2),
 (4, 2),
 (24, 12),
 (9, 5),
 (13, 7),
 (53, 27),
 (22, 11),
 (1, 1),
 (1, 1),
 (1, 1),
 (1, 1),
 (1, 1),
 (1, 1)]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = md.get_learner(emb_szs, len(df.columns)-len(cat_vars),</span><br><span class="line">                   <span class="number">0.04</span>, <span class="number">1</span>, [<span class="number">1000</span>,<span class="number">500</span>], [<span class="number">0.001</span>,<span class="number">0.01</span>], y_range=y_range)</span><br><span class="line">lr = <span class="number">1e-3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.lr_find()</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=1), HTML(value=&apos;&apos;)))


 60%|    | 3930/6597 [02:43&lt;01:50, 24.04it/s, loss=0.483]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.sched.plot(<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><img src="output_105_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.sched.plot(n_skip=<span class="number">500</span>, n_skip_end=<span class="number">30</span>)</span><br></pre></td></tr></table></figure>
<p><img src="output_106_0.png" alt="png"></p>
<pre><code>60%|    | 3930/6597 [03:00&lt;02:02, 21.83it/s, loss=0.483]
</code></pre><h3 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = md.get_learner(emb_szs, len(df.columns)-len(cat_vars),</span><br><span class="line">                   <span class="number">0.04</span>, <span class="number">1</span>, [<span class="number">1000</span>,<span class="number">500</span>], [<span class="number">0.001</span>,<span class="number">0.01</span>], y_range=y_range)</span><br><span class="line">lr = <span class="number">1e-3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">3</span>, metrics=[exp_rmspe])</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=3), HTML(value=&apos;&apos;)))


epoch      trn_loss   val_loss   exp_rmspe                      
    0      0.015739   0.0        0.000126  
 84%| | 5544/6597 [05:05&lt;00:58, 18.15it/s, loss=0.0114]


---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

&lt;ipython-input-90-8857f3701be9&gt; in &lt;module&gt;()
----&gt; 1 m.fit(lr, 3, metrics=[exp_rmspe])


~/Downloads/fastai-master/courses/dl1/fastai/learner.py in fit(self, lrs, n_cycle, wds, **kwargs)
    285         self.sched = None
    286         layer_opt = self.get_layer_opt(lrs, wds)
--&gt; 287         return self.fit_gen(self.model, self.data, layer_opt, n_cycle, **kwargs)
    288
    289     def warm_up(self, lr, wds=None):


~/Downloads/fastai-master/courses/dl1/fastai/learner.py in fit_gen(self, model, data, layer_opt, n_cycle, cycle_len, cycle_mult, cycle_save_name, best_save_name, use_clr, use_clr_beta, metrics, callbacks, use_wd_sched, norm_wds, wds_sched_mult, use_swa, swa_start, swa_eval_freq, **kwargs)
    232             metrics=metrics, callbacks=callbacks, reg_fn=self.reg_fn, clip=self.clip, fp16=self.fp16,
    233             swa_model=self.swa_model if use_swa else None, swa_start=swa_start,
--&gt; 234             swa_eval_freq=swa_eval_freq, **kwargs)
    235
    236     def get_layer_groups(self): return self.models.get_layer_groups()


~/Downloads/fastai-master/courses/dl1/fastai/model.py in fit(model, data, n_epochs, opt, crit, metrics, callbacks, stepper, swa_model, swa_start, swa_eval_freq, **kwargs)
    127             batch_num += 1
    128             for cb in callbacks: cb.on_batch_begin()
--&gt; 129             loss = model_stepper.step(V(x),V(y), epoch)
    130             avg_loss = avg_loss * avg_mom + loss * (1-avg_mom)
    131             debias_loss = avg_loss / (1 - avg_mom**batch_num)


~/Downloads/fastai-master/courses/dl1/fastai/model.py in step(self, xs, y, epoch)
     59         if self.clip:   # Gradient clipping
     60             nn.utils.clip_grad_norm(trainable_params_(self.m), self.clip)
---&gt; 61         self.opt.step()
     62         if self.fp16:
     63             copy_fp32_to_model(self.m, self.fp32_params)


~/anaconda3/envs/fastai/lib/python3.6/site-packages/torch/optim/adam.py in step(self, closure)
     76                 step_size = group[&apos;lr&apos;] * math.sqrt(bias_correction2) / bias_correction1
     77
---&gt; 78                 p.data.addcdiv_(-step_size, exp_avg, denom)
     79
     80         return loss


KeyboardInterrupt:


 84%| | 5544/6597 [05:20&lt;01:00, 17.32it/s, loss=0.0114]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">5</span>, metrics=[exp_rmspe], cycle_len=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">2</span>, metrics=[exp_rmspe], cycle_len=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<h3 id="All"><a href="#All" class="headerlink" title="All"></a>All</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = md.get_learner(emb_szs, len(df.columns)-len(cat_vars),</span><br><span class="line">                   <span class="number">0.04</span>, <span class="number">1</span>, [!<span class="number">1000</span>,<span class="number">500</span>], [<span class="number">0.001</span>,<span class="number">0.01</span>], y_range=y_range)</span><br><span class="line">lr = <span class="number">1e-3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">1</span>, metrics=[exp_rmspe])</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=1), HTML(value=&apos;&apos;)))


epoch      trn_loss   val_loss   exp_rmspe                      
    0      0.013963   7.3e-05    0.008606  





[array([0.00007]), 0.00860554908908337]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">3</span>, metrics=[exp_rmspe])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">3</span>, metrics=[exp_rmspe], cycle_len=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=6), HTML(value=&apos;&apos;)))


epoch      trn_loss   val_loss   exp_rmspe                       
    0      0.009228   0.002726   0.05087   
    1      0.008263   1e-06      0.000763                        
    2      0.008516   0.006769   0.085751                        
    3      0.007368   0.003131   0.057547                        
    4      0.008081   5.8e-05    0.007615                        
    5      0.006245   0.001258   0.0361                          





[array([0.00126]), 0.03609959099673205]
</code></pre><h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = md.get_learner(emb_szs, len(df.columns)-len(cat_vars),</span><br><span class="line">                   <span class="number">0.04</span>, <span class="number">1</span>, [<span class="number">1000</span>,<span class="number">500</span>], [<span class="number">0.001</span>,<span class="number">0.01</span>], y_range=y_range)</span><br><span class="line">lr = <span class="number">1e-3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">3</span>, metrics=[exp_rmspe])</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=3), HTML(value=&apos;&apos;)))


epoch      trn_loss   val_loss   exp_rmspe                      
    0      0.014125   0.009788   0.103991  
    1      0.01025    0.000119   0.010829                       
    2      0.009337   0.000527   0.023217                        





[array([0.00053]), 0.023216503291080177]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.fit(lr, <span class="number">3</span>, metrics=[exp_rmspe], cycle_len=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>HBox(children=(IntProgress(value=0, description=&apos;Epoch&apos;, max=6), HTML(value=&apos;&apos;)))


100%|| 6596/6597 [04:49&lt;00:00, 22.82it/s, loss=0.00767]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.save(<span class="string">'val0'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.load(<span class="string">'val0'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x,y=m.predict_with_targs()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp_rmspe(x,y)</span><br></pre></td></tr></table></figure>
<pre><code>0.0200690704704678
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred_test=m.predict(<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred_test = np.exp(pred_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined_test[<span class="string">'Sales'</span>]=pred_test</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csv_fn=<span class="string">f'<span class="subst">&#123;PATH&#125;</span>tmp/sub.csv'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joined_test[[<span class="string">'Id'</span>,<span class="string">'Sales'</span>]].to_csv(csv_fn, index=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileLink(csv_fn)</span><br></pre></td></tr></table></figure>
<p><a href="data/rossmann/tmp/sub.csv" target="_blank">data/rossmann/tmp/sub.csv</a><br></p>
<h2 id="RF"><a href="#RF" class="headerlink" title="RF"></a>RF</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((val,trn), (y_val,y_trn)) = split_by_idx(val_idx, df.values, yl)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = RandomForestRegressor(n_estimators=<span class="number">40</span>, max_features=<span class="number">0.99</span>, min_samples_leaf=<span class="number">2</span>,</span><br><span class="line">                          n_jobs=<span class="number">-1</span>, oob_score=<span class="keyword">True</span>)</span><br><span class="line">m.fit(trn, y_trn);</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">preds = m.predict(val)</span><br><span class="line">m.score(trn, y_trn), m.score(val, y_val), m.oob_score_, exp_rmspe(preds, y_val)</span><br></pre></td></tr></table></figure>
<pre><code>(0.9799520464753252, 0.0, 0.9162951214656377, 0.030483395818497558)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x,y=m.predict_with_targs()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/09/27/undefined  tle/" rel="next" title="LSTM: Text Generator using PyTorch">
                <i class="fa fa-chevron-left"></i> LSTM: Text Generator using PyTorch
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/09/28/undefined  tle/" rel="prev" title="Image Classification-Done Successfully">
                Image Classification-Done Successfully <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Sahil Bansal</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#collapse"><span class="nav-number">1.</span> <span class="nav-text">collapse</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number"></span> <span class="nav-text"> Shape of Weather is : ,39 </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number"></span> <span class="nav-text"> Table Names - train, store, store_states, state_names, googletrend, weather, test </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number"></span> <span class="nav-text">Making new colums in google trends</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Durations"><span class="nav-number"></span> <span class="nav-text">Durations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-features"><span class="nav-number"></span> <span class="nav-text">Create features</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DL"><span class="nav-number"></span> <span class="nav-text">DL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample"><span class="nav-number">1.</span> <span class="nav-text">Sample</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#All"><span class="nav-number">2.</span> <span class="nav-text">All</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Test"><span class="nav-number">3.</span> <span class="nav-text">Test</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RF"><span class="nav-number"></span> <span class="nav-text">RF</span></a></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sahil Bansal</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
